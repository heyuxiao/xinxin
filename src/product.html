<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="./lib/css/swiper.min.css"/>
		<link rel="stylesheet" type="text/css" href="./css/product.css"/>
	</head>
	<body>
		<header>
			<div class="header_one">
				<div class="container">
					<ul class="list_tablink">
						<li><a href="./index.html">X-KICKS商城</a></li>
						<li><a href="#">X-KICKS咨询</a></li>
						<li><a href="#">X-KICKS社区</a></li>
						<li><a href="#">X-KICKS APP</a></li>
					</ul>
					<ul class="list_fr">
						<li id="listShow"></li>
						<li id="listLogin">
							<a href="http://localhost/xinxin/dist/logins.html" class="font_write">登陆</a>
							<a href="http://localhost/xinxin/dist/login.html">注册</a>
						</li>
						<li>|</li>
						<li>
							<a href="#">订单</a>
							<a href="#">收藏</a>
							<a href="#">帮助中心</a>
							<a href="#">收藏新新</a>
							<a href="#" class="hot_p">400-881-9878</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="header_two">
				<div class="container two">
					<div id="logo">
						<img src="http://www.x-kicks.com/themes/newshoes/images/logo.png" >
					</div>
					<div id="search">
						<form>
							<input type="text" class="text"><input type="button" value="搜索" class="btn"/>
						</form>
					</div>
					<div id="shopping-cart">
						<a href="./car.html">我的购物车</a>(<a href="#" class="numArr">0</a>)
					</div>
				</div>
			</div>
		</header>
		<div id="nav">
			<div class="container nav">
				<ul>
					<li><a href="./index.html">首&nbsp;&nbsp;&nbsp;页</a></li>
					<li>/</li>
					<li><a href="#">最新上架</a></li>
					<li>/</li>
					<li><a href="#">男鞋</a></li>
					<li>/</li>
					<li><a href="#">女鞋</a></li>
					<li>/</li>
					<li><a href="#">潮流鞋</a></li>
					<li>/</li>
					<li><a href="#">服饰配件</a></li>
					<li>/</li>
					<li><a href="#">最新打折</a></li>
					<li>/</li>
					<li><a href="#">潮流专题</a></li>
					<li>/</li>
					<li><a href="#">品牌一览</a></li>
				</ul>
			</div>
		</div>

		<div class="container" id="main">
			
			
			
		</div>


		<footer id="footer">
			<div class="container">
				<div class="mod_safe_box">
					<div class="mod_safe_nav">
						<ul>
							<li><i></i></li>
							<li>
								<h5 class="mod_safe_nav_tit">正品保障</h5>
								<h3 class="mod_safe_nav_titen">Genuine</h3>
							</li>
						</ul>
					</div>
					<div class="mod_safe_nav">
						<ul>
							<li><i></i></li>
							<li>
								<h5 class="mod_safe_nav_tit">实物拍摄</h5>
								<h3 class="mod_safe_nav_titen">HD phofography</h3>
							</li>
						</ul>
					</div>
					<div class="mod_safe_nav">
						<ul>
							<li><i></i></li>
							<li>
								<h5 class="mod_safe_nav_tit">闪电发货</h5>
								<h3 class="mod_safe_nav_titen">Rushi Delivery</h3>
							</li>
						</ul>
					</div>
					<div class="mod_safe_nav">
						<ul>
							<li><i></i></li>
							<li>
								<h5 class="mod_safe_nav_tit">无理由退换货</h5>
								<h3 class="mod_safe_nav_titen">Free refun</h3>
							</li>
						</ul>
					</div>
				</div>
				<div class="mod_help_box">
					<div class="mod_help_nav">
						<h5 class="mod_help_nav_tit">新手上路</h5>
						<ul class="mod_help_nav_con">
							<li><a href="#">新用户注册</a></li>
							<li><a href="#">新手常见问题</a></li>
							<li><a href="#">购物流程和购物车</a></li>
							<li><a href="#">如何成为VIP会员</a></li>
							<li><a href="#">积分说明</a></li>
						</ul>
					</div>
					<div class="mod_help_nav">
						<h5 class="mod_help_nav_tit">关于商品</h5>
						<ul class="mod_help_nav_con">
							<li><a href="#">正品 承诺</a></li>
							<li><a href="#">关于商品详细信息</a></li>
							<li><a href="#">我们的品牌</a></li>
							<li><a href="#">尺码对照表</a></li>
						</ul>
					</div>
					<div class="mod_help_nav">
						<h5 class="mod_help_nav_tit">付款方式</h5>
						<ul class="mod_help_nav_con">
							<li><a href="#">银行柜台汇款</a></li>
							<li><a href="#">货到付款</a></li>
							<li><a href="#">网上在线支付</a></li>
							<li><a href="#">如何使用优惠券</a></li>
						</ul>
					</div>
					<div class="mod_help_nav">
						<h5 class="mod_help_nav_tit">配送方式</h5>
						<ul class="mod_help_nav_con">
							<li><a href="#">配送方式</a></li>
							<li><a href="#">配送时间</a></li>
							<li><a href="#">配送范围</a></li>
							<li><a href="#">快件查询</a></li>
						</ul>
					</div>
					<div class="mod_help_nav">
						<h5 class="mod_help_nav_tit">售后服务</h5>
						<ul class="mod_help_nav_con">
							<li><a href="#">商品的签收与拒收</a></li>
							<li><a href="#">商品退换货政策</a></li>
							<li><a href="#">售后投诉</a></li>
							<li><a href="#">营业执照报备信息</a></li>
							<li><a href="#">预售商品售后政策</a></li>
						</ul>
					</div>
					<div class="mod_help_nav">
						<h5 class="mod_help_nav_tit">在线帮助</h5>
						<ul class="mod_help_nav_con">
							<li><a href="#">在线客服</a></li>
							<li><a href="#">招贤纳士</a></li>
							<li><a href="#">警惕网络诈骗</a></li>
							<li><a href="#">品牌招商</a></li>
							<li><a href="#">手机APP下载</a></li>
						</ul>
					</div>
				</div>
				<p class="foot_copy">2016-2019  新新球鞋网 版权所有，并保留所有权利。浙公安备33108202000112号  浙ICP备19043343号 </p>
				<div class="ad_link_box">
					<a href="#"><img src="http://www.x-kicks.com/themes/newshoes/images/ad_link_img2.jpg" ></a>
					<a href="#"><img src="http://www.x-kicks.com/themes/newshoes/images/ad_link_img3.jpg" ></a>
					<a href="#"><img src="http://www.x-kicks.com/themes/newshoes/images/ad_link_img5.jpg" ></a>
					<a href="#"><img src="http://www.x-kicks.com/themes/newshoes/images/ad_link_img6.jpg" ></a>
				</div>
			</div>
		</footer>
		
		<script type="text/javascript" src="./lib/js/jquery.min.js"></script>
		<script type="text/javascript" src="./lib/js/swiper.min.js"></script>
		<script type="text/javascript" src="./js/all.min.js"></script>
		<script type="text/javascript">
			
			var xhr = new XMLHttpRequest;
			xhr.open('post','http://localhost/xinxin/dist/logins.php')
			xhr.send(null);
			xhr.onreadystatechange = function(){
				if(xhr.readyState==4&&xhr.status==200){
					if(xhr.responseText==1){
						$('#listLogin').css('display','none');
						$('#listShow').html(decodeURIComponent(getCookie('name'))+'<a href="#" id="logOut">退出</a>')
						
					}
				}
			}
			
			$('#listShow').on('click',$('#logOut'),function(){
				
				removeCookie('name');
				removeCookie('password');
				$('#listLogin').css('display','block');
				$('#listShow').css('display','none')
			})
			
			var id = getCookie('id');
			var xhr1 = new XMLHttpRequest;
			xhr1.open('get','./products.json');
			xhr1.send(null);
			xhr1.onload = function(){
					var json = JSON.parse(xhr1.responseText)[id];
					console.log(json)
					var json1 = JSON.parse(xhr1.responseText);
					var box = $('<div class="imgBox"><img src="'+json.pic+'" ></div><div class="productBox"><h2>'+json.name+'</h2><p class="p1">商品货号：<span>'+json.id+'</span></p><p class="p2">本店售价：<span>'+json.price+'</span></p><a href="#" class="addCart">加入购物车</a></div>')
					$('#main').html(box);
					
					
					(function(){
					
						var products = json1
					
						class ShoppingCart{
							constructor(containerId,products){
								this.container = document.getElementById(containerId);//购物车和商品列表所在的容器
								this.products = products;//为了后面的方法都可以使用products
								this.cartProducts = this.getStorage()||[];//购物车里面的商品集合
							}
							setStorage(json1){
								localStorage.setItem('cart',JSON.stringify(json1));
							}
							getStorage(){
								return JSON.parse(localStorage.getItem('cart'))||[];
							}
							addCartListEvent(){
								//添加加入购物车事件
								var that = this;//that是实例对象
								
								var addCartBtnArr = this.container.querySelectorAll('.addCart')[0];//当前购物车里面的加入购物车按钮
									addCartBtnArr.onclick = function(){
										//事件函数中的this是事件源:当前被点击的a标签
										var currentProduct = {
											name:$('.productBox h2').html(),
											price:$('.p2 span').html(),
											pic:$('.imgBox img').attr('src'),
											id:$('.p1 span').html(),
										}	
										that.addToCartProducts(currentProduct);
									}
							}
							addToCartProducts(currentProduct){
								this.cartProducts = this.getStorage();
								//该方法负责接收一个新商品信息,然后把这个商品信息加入到本地存储中			
								for(var i=0;i<this.cartProducts.length;i++){
									if(this.cartProducts[i].id==currentProduct.id){
										//如果你传入的这个新商品在购物车列表中有重复,就直接把购物车列表中这个重复的商品数量加1
										this.cartProducts[i].num++;
										this.setStorage(this.cartProducts);
										return;
									}
								}
								//如果你传入的这个新商品在购物车列表中没有重复,就直接添加到购物车列表中,数量为1
								currentProduct.num = 1;
								//
								this.cartProducts.push(currentProduct);		
								this.setStorage(this.cartProducts);
							}
							
						}
						var car = new ShoppingCart("main",products);
						car.addCartListEvent()
					})()
				}
				
				
				
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		</script>
	</body>
</html>
